/* ======================================================= 
 * Auto Albums - Multi Level Responsive Grid
 * By David Blanco
 *
 * Contact: http://codecanyon.net/user/davidbo90
 *
 * Created: July 23, 2013
 *
 * Copyright (c) 2013, David Blanco. All rights reserved.
 * Released under CodeCanyon License http://codecanyon.net/
 *
 * Note: Script based in jQuery Masonry v2.1.07 made by David DeSandro http://masonry.desandro.com/ (under MIT)
 *
 * ======================================================= */

!function(t,i){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",i):"object"==typeof module&&module.exports?module.exports=i():t.EvEmitter=i()}(this,function(){function t(){}var i=t.prototype;return i.on=function(t,i){if(t&&i){var e=this._events=this._events||{},o=e[t]=e[t]||[];return-1==o.indexOf(i)&&o.push(i),this}},i.once=function(t,i){if(t&&i){this.on(t,i);var e=this._onceEvents=this._onceEvents||{},o=e[t]=e[t]||[];return o[i]=!0,this}},i.off=function(t,i){var e=this._events&&this._events[t];if(e&&e.length){var o=e.indexOf(i);return-1!=o&&e.splice(o,1),this}},i.emitEvent=function(t,i){var e=this._events&&this._events[t];if(e&&e.length){var o=0,s=e[o];i=i||[];for(var n=this._onceEvents&&this._onceEvents[t];s;){var a=n&&n[s];a&&(this.off(t,s),delete n[s]),s.apply(this,i),o+=a?0:1,s=e[o]}return this}},t}),function(t,i){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(e){return i(t,e)}):"object"==typeof module&&module.exports?module.exports=i(t,require("ev-emitter")):t.imagesLoaded=i(t,t.EvEmitter)}(window,function(t,i){function e(t,i){for(var e in i)t[e]=i[e];return t}function o(t){var i=[];if(Array.isArray(t))i=t;else if("number"==typeof t.length)for(var e=0;e<t.length;e++)i.push(t[e]);else i.push(t);return i}function s(t,i,n){return this instanceof s?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=o(t),this.options=e({},this.options),"function"==typeof i?n=i:e(this.options,i),n&&this.on("always",n),this.getImages(),r&&(this.jqDeferred=new r.Deferred),void setTimeout(function(){this.check()}.bind(this))):new s(t,i,n)}function n(t){this.img=t}function a(t,i){this.url=t,this.element=i,this.img=new Image}var r=t.jQuery,h=t.console;s.prototype=Object.create(i.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var i=t.nodeType;if(i&&d[i]){for(var e=t.querySelectorAll("img"),o=0;o<e.length;o++){var s=e[o];this.addImage(s)}if("string"==typeof this.options.background){var n=t.querySelectorAll(this.options.background);for(o=0;o<n.length;o++){var a=n[o];this.addElementBackgroundImages(a)}}}};var d={1:!0,9:!0,11:!0};return s.prototype.addElementBackgroundImages=function(t){var i=getComputedStyle(t);if(i)for(var e=/url\((['"])?(.*?)\1\)/gi,o=e.exec(i.backgroundImage);null!==o;){var s=o&&o[2];s&&this.addBackground(s,t),o=e.exec(i.backgroundImage)}},s.prototype.addImage=function(t){var i=new n(t);this.images.push(i)},s.prototype.addBackground=function(t,i){var e=new a(t,i);this.images.push(e)},s.prototype.check=function(){function t(t,e,o){setTimeout(function(){i.progress(t,e,o)})}var i=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(i){i.once("progress",t),i.check()}):void this.complete()},s.prototype.progress=function(t,i,e){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,i]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&h&&h.log("progress: "+e,t,i)},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var i=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[i](this)}},n.prototype=Object.create(i.prototype),n.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},n.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},n.prototype.confirm=function(t,i){this.isLoaded=t,this.emitEvent("progress",[this,this.img,i])},n.prototype.handleEvent=function(t){var i="on"+t.type;this[i]&&this[i](t)},n.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},n.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},n.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},a.prototype=Object.create(n.prototype),a.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},a.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},a.prototype.confirm=function(t,i){this.isLoaded=t,this.emitEvent("progress",[this,this.element,i])},s.makeJQueryPlugin=function(i){i=i||t.jQuery,i&&(r=i,r.fn.imagesLoaded=function(t,i){var e=new s(this,t,i);return e.jqDeferred.promise(r(this))})},s.makeJQueryPlugin(),s}),function(t){function i(i){t(this).touchSwipeLeft(i).touchSwipeRight(i)}function e(i){var e=t(this);e.data("swipeLeft")||e.data("swipeLeft",i),e.data("swipeRight")||s(e)}function o(i){var e=t(this);e.data("swipeRight")||e.data("swipeRight",i),e.data("swipeLeft")||s(e)}function s(t){t.unbindSwipe(!0).bind(h,n)}function n(i){function e(t){m.unbind(r),f&&h&&u>h-f&&Math.abs(g-s)>d&&Math.abs(v-n)<l&&(g>s?m.data("swipeLeft")&&m.data("swipeLeft")("left"):m.data("swipeRight")&&m.data("swipeRight")("right")),f=h=null}function o(t){f&&(p=t.originalEvent.touches?t.originalEvent.touches[0]:t,h=(new Date).getTime(),s=p.pageX,n=p.pageY,Math.abs(g-s)>c&&t.preventDefault())}var s,n,h,f=(new Date).getTime(),p=i.originalEvent.touches?i.originalEvent.touches[0]:i,m=t(this).bind(r,o).one(a,e),g=p.pageX,v=p.pageY;m.data("stopPropagation")&&i.stopImmediatePropagation()}var a,r,h,d=30,l=75,c=10,u=1e3;"ontouchend"in document?(a="touchend.cj_swp",r="touchmove.cj_swp",h="touchstart.cj_swp"):(a="mouseup.cj_swp",r="mousemove.cj_swp",h="mousedown.cj_swp"),t.fn.touchSwipe=function(t,e){return e&&this.data("stopPropagation",!0),t?this.each(i,[t]):void 0},t.fn.touchSwipeLeft=function(t,i){return i&&this.data("stopPropagation",!0),t?this.each(e,[t]):void 0},t.fn.touchSwipeRight=function(t,i){return i&&this.data("stopPropagation",!0),t?this.each(o,[t]):void 0},t.fn.unbindSwipeLeft=function(){this.removeData("swipeLeft"),this.data("swipeRight")||this.unbindSwipe(!0)},t.fn.unbindSwipeRight=function(){this.removeData("swipeRight"),this.data("swipeLeft")||this.unbindSwipe(!0)},t.fn.unbindSwipe=function(t){return t||this.removeData("swipeLeft swipeRight stopPropagation"),this.unbind(h+" "+r+" "+a)}}(jQuery),function(t,i,e){"use strict";var o,s=i.event,n=i.event.handle?"handle":"dispatch";s.special.smartresize={setup:function(){i(this).bind("resize",s.special.smartresize.handler)},teardown:function(){i(this).unbind("resize",s.special.smartresize.handler)},handler:function(t,i){var e=this,a=arguments;t.type="smartresize",o&&clearTimeout(o),o=setTimeout(function(){s[n].apply(e,a)},"execAsap"===i?0:100)}},i.fn.smartresize=function(t){return t?this.bind("smartresize",t):this.trigger("smartresize",["execAsap"])},i.Mason=function(t,e){this.element=i(e),this._create(t),this._init()},i.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500,complete:function(){var t=i(this);t.hasClass("grid-brick")||(i.fn.grid.defaults.lazyLoad&&i.waypoints("refresh"),t.hasClass("grid-with-loading-boxes")&&(t.removeClass("grid-with-loading-boxes"),t.addClass("completeAddingImages")))}},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},i.Mason.prototype={_resized:!1,_filterFindBricks:function(t){var i=this.options.itemSelector;return i?t.filter(i).add(t.find(i)):t},_getBricks:function(t){var i=this._filterFindBricks(t).css({position:"absolute"}).addClass("grid-brick");return i},_create:function(e){this.options=i.extend(!0,{},i.Mason.settings,e),this.styleQueue=[];var o=this.element[0].style;this.originalStyle={height:o.height||""};var s=this.options.containerStyle;for(var n in s)this.originalStyle[n]=o[n]||"";this.element.css(s),this.horizontalDirection=this.options.isRTL?"right":"left";var a=this.element.css("padding-"+this.horizontalDirection),r=this.element.css("padding-top");this.offset={x:a?parseInt(a,10):0,y:r?parseInt(r,10):0},this.isFluid=this.options.columnWidth&&"function"==typeof this.options.columnWidth;var h=this;setTimeout(function(){h.element.addClass("grid")},0),this.options.isResizable&&i(t).bind("smartresize.grid",function(){h.resize()}),this.reloadItems()},_init:function(t){this._getColumns(),this._reLayout(t)},option:function(t,e){i.isPlainObject(t)&&(this.options=i.extend(!0,this.options,t))},layout:function(t,i){for(var e=0,o=t.length;o>e;e++)this._placeBrick(t[e]);var s={};if(s.height=Math.max.apply(Math,this.colYs),this.options.isFitWidth){var n=0;for(e=this.cols;--e&&0===this.colYs[e];)n++;s.width=(this.cols-n)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:s});var a,r=this.isLaidOut&&this.options.isAnimated?"animate":"css",h=this.options.animationOptions,d=!1;for(e=0,o=this.styleQueue.length;o>e;e++){a=this.styleQueue[e],r=this.isLaidOut&&this.options.isAnimated?"animate":"css";var l=a.$el.hasClass("loading-box");l&&!this.element.hasClass("noSupportTransform")?(r="css",d=!0):d&&a.$el.css(a.style,h),a.$el.removeClass("loading-box");var c=a.$el.css("left"),u=a.$el.css("top"),f=a.style.left+"px",p=a.style.top+"px";c==f&&u==p||1==l?a.$el.data("moving",!1):a.$el.data("moving",!0),a.$el[r](a.style,h)}this.styleQueue=[],i&&i.call(t),this.isLaidOut=!0},_getColumns:function(){var t=this.options.isFitWidth?this.element.parent():this.element,i=t.width();this.columnWidth=this.isFluid?this.options.columnWidth(i):this.options.columnWidth||this.$bricks.outerWidth(!0)||i,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((i+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(t){var e,o,s,n,a,r=i(t);if(e=Math.ceil(r.outerWidth(!0)/this.columnWidth),e=Math.min(e,this.cols),1===e)s=this.colYs;else for(o=this.cols+1-e,s=[],a=0;o>a;a++)n=this.colYs.slice(a,a+e),s[a]=Math.max.apply(Math,n);for(var h=Math.min.apply(Math,s),d=0,l=0,c=s.length;c>l;l++)if(s[l]===h){d=l;break}var u={top:h+this.offset.y};u[this.horizontalDirection]=this.columnWidth*d+this.offset.x,this.styleQueue.push({$el:r,style:u});var f=h+r.outerHeight(!0),p=this.cols+1-c;for(l=0;p>l;l++)this.colYs[d+l]=f},resize:function(){var t=this.cols;this._getColumns(),(this.isFluid||this.cols!==t)&&this._reLayout()},_reLayout:function(t){var i=this.cols;for(this.colYs=[];i--;)this.colYs.push(0);this.layout(this.$bricks,t)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(t){this.reloadItems(),this._init(t)},appended:function(t,i,e){if(i){this._filterFindBricks(t).css({top:this.element.height()});var o=this;setTimeout(function(){o._appended(t,e)},1)}else this._appended(t,e)},_appended:function(t,i){var e=this._getBricks(t);this.$bricks=this.$bricks.add(e),this.layout(e,i)},remove:function(t){this.$bricks=this.$bricks.not(t),t.remove()},destroy:function(){this.$bricks.removeClass("grid-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var e=this.element[0].style;for(var o in this.originalStyle)e[o]=this.originalStyle[o];this.element.unbind(".grid").removeClass("grid").removeData("grid"),i(t).unbind(".grid")}};var a=function(i){t.console&&t.console.error(i)};i.fn.grid=function(o){var s=function(s){var n=i.extend({},i.fn.grid.defaults,o);o.lazyLoad!=e&&(i.fn.grid.defaults.lazyLoad=o.lazyLoad),o==e&&(o={}),o.isFitWidth=n.isFitWidth,o.isAnimated=n.isAnimated,o.itemSelector=".gbox",o.gutterWidth=n.horizontalSpaceBetweenThumbnails;var a=i(s).addClass("centered").addClass("grid-clearfix"),r=n.columnWidth;"auto"==r?o.columnWidth=function(t){for(var i=-999,e=n.columns;e>=1;e--)i<n.columnMinWidth&&(i=(t-(e-1)*o.gutterWidth)/e|0);return a.find("div.gbox").width(i),i}:"function"!=typeof r&&(o.columnWidth=function(t){var i=r;return a.find("div.gbox").width(i),i}),a.find("div.gbox").css("margin-bottom",n.verticalSpaceBetweenThumbnails);var h=function(){var t=document.createElement("div"),i="Khtml ms O Moz Webkit".split(" "),e=i.length;return function(o){if(o in t.style)return!0;for(o=o.replace(/^[a-z]/,function(t){return t.toUpperCase()});e--;)if(i[e]+o in t.style)return!0;return!1}}();h("transform")?a.addClass("visible"):a.addClass("noSupportTransform");var d=null,l=a.data("directory"),c=i("<div />").insertAfter(a),u=function(){c.addClass("grid-loader").removeClass("grid-loadMore").html("")},f=function(){c.removeClass("grid-loader")},p=!1,m=function(){var t=0;for(var i in d){d[i];t++}return t>0?(p=!1,!0):!1},g=function(t){t?c.addClass("grid-loadMore").html("LOAD MORE"):c.removeClass("grid-loadMore").html("")},v=l,y=v,b=decodeURI(location.hash.substr(1));""!=b&&n.hashTag&&"*"!=b&&(v+="/"+b,l+="/"+b);var x=function(t){return"-"==t.substr(1,1)?t.substr(2):t},w=function(t,i){var e="";"yes"==i&&(e="thumbnails/");var o=t.split(/\.(?=[^.]*$)/)[0],s="";if(-1!=o.indexOf("$$")){var n=o.split("$$");o=n[0];var a=n[1].split(":").join("/");a=a.split("|").join("/"),s='data-url="'+a+'"'}o=x(o);var r='<div class="gbox" '+s+'><img src="'+v+"/"+e+t+'" data-lightbox="'+v+"/"+t+'" /><div class="image-caption"><h4>'+o+'</h4></div><div class="lightbox-text">'+o+"</div></div>";return r},C=function(t,i,e){var o="";"yes"==e.thumb&&(o="thumbnails/");var s=x(t),a='<i class="icon-folder-open icon-white" style="margin-right:5px;"></i>'+e.numFolders,r='<i class="icon-picture icon-white" style="margin:0 5px 0 5px;"></i>'+e.numImages;n.showNumFolder||(a=""),n.showNumImages||(r=""),n.autoHideNumFolder&&0==e.numFolders&&(a=""),n.autoHideNumImages&&0==e.numImages&&(r="");var h="";0==e.numImages&&""==i&&(h='style="height:200px"');var d='<div class="gbox gridFolder" data-folder="'+t+'" '+h+'><img src="'+v+"/"+t+"/"+o+i+'" /><div class="gradient-container"><div class="folder-info"><div class="folder-name">'+s+'</div><div class="folder-count">'+a+r+"</div></div></div></div>";return d},k=function(t){t.each(function(){var t=i(this).removeClass("noTransform");t.hasClass("grid-brick")&&(t.is(":hidden")?a.hasClass("noSupportTransform")?t.show():(t.show(),0==t.data("moving")?(t.animate(n.hiddenStyle,0),t.animate(n.visibleStyle,o.animOpts,function(){t.addClass("noTransform")})):(t.animate(n.visibleStyle,0),t.addClass("noTransform"))):t.animate(n.visibleStyle,o.animOpts,function(){t.addClass("noTransform")}))})},T=function(t){t=i(t).addClass("loading-box"),t.css("margin-bottom",n.verticalSpaceBetweenThumbnails),a.append(t.hide()),a.imagesLoaded(function(){t.hide().css({top:200,left:200}),a.addClass("grid-with-loading-boxes"),a.grid("reload"),k(t),f(),g(m()),p=!1})},S=function(t){u();var i=new Array;if(n.foldersAtTop){for(var e in d)"string"==typeof d[e]||i.push({image:e,thumb:d[e],folder:"yes"});for(var e in d)"string"==typeof d[e]&&i.push({image:e,thumb:d[e],folder:"no"})}else for(var e in d){var o="yes";"string"==typeof d[e]&&(o="no"),i.push({image:e,thumb:d[e],folder:o})}for(var s="",a=0;t>a&&!(a>=i.length);){var r=i[a],h=r.image.split(/\.(?=[^.]*$)/)[0];if("folderCover"!=h)if("yes"==r.folder){var l=r.thumb.image;s+=C(r.image,l,r.thumb)}else s+=w(r.image,r.thumb);delete d[r.image],a++}T(s)},I=function(){c.hasClass("grid-loadMore")&&S(n.imagesToLoad)};c.on("click",function(){I()}),n.lazyLoad&&a.waypoint(function(t){var e=i(this);e.hasClass("completeAddingImages")&&(e.removeClass("completeAddingImages"),c.hasClass("grid-loadMore")&&I())},{context:t,continuous:!0,enabled:!0,horizontal:!1,offset:"bottom-in-view",triggerOnce:!1});var B=i('<ul class="grid-breadcrumb grid-clearfix"></ul>');n.showNavBar&&B.insertBefore(a);var L=function(){for(var t=v.split("/"),i="",e="",o="",s="",a=0;a<t.length;a++){e+=""==e?t[a]:"/"+t[a];var r=x(t[a]);if(""==o){if(e!=y)continue;o="found it"}e!=y&&(s+="/"+t[a]),i+=a==t.length-1?'<li data-directory="'+e+'" class="active">'+r+"</li>":'<li data-directory="'+e+'"><a>'+r+'</a><span class="divider">/</span></li>'}n.hashTag&&""!=s.substr(1)?location.hash=s.substr(1):n.hashTag&&""==s.substr(1)&&(location.hash="*"),B.html(i)};L();var E=function(){a.find(".gbox").remove().end().css("height",0),c.removeClass("grid-loadMore").html(""),L(),u(),i.getJSON("reader.php?directory="+encodeURIComponent(v)+"&albumsOrder="+n.albumsOrder+"&imagesOrder="+n.imagesOrder+"&folderCoverRandom="+n.folderCoverRandom,function(t){d=t,S(n.imagesToLoadStart)})};B.on("click","a",function(){v=i(this).parent("li").data("directory"),E()}),a.on("click","div.gridFolder",function(){var t=i(this).data("folder");v+="/"+t,E()}),u(),i.getJSON("reader.php?directory="+encodeURIComponent(l)+"&albumsOrder="+n.albumsOrder+"&imagesOrder="+n.imagesOrder+"&folderCoverRandom="+n.folderCoverRandom,function(t){d=t,S(n.imagesToLoadStart)}),a.on("mouseenter.hoverdir, mouseleave.hoverdir","div.gbox",function(t){if(n.caption){var o=i(this),s=t.type,a=o.find("div.image-caption"),r=_(o,{x:t.pageX,y:t.pageY}),h=W(r,o),d=a.children("div.aligment");if(d[0]==e){var l=a.html();a.html("<div class='aligment'><div class='aligment'>"+l+"</div></div>")}if("mouseenter"===s){if("classic"==n.captionType)return a.css({left:0,top:0}),void a.fadeIn(300);a.css({left:h.from,top:h.to}),a.stop().show().fadeTo(0,1,function(){i(this).stop().animate({top:0,left:0},200,"linear")})}else{if("classic"==n.captionType)return a.css({left:0,top:0}),void a.fadeOut(300);"grid-fade"==n.captionType?a.fadeOut(700):a.stop().animate({left:h.from,top:h.to},200,"linear",function(){a.hide()})}}});var _=function(t,i){var e=t.width(),o=t.height(),s=(i.x-t.offset().left-e/2)*(e>o?o/e:1),n=(i.y-t.offset().top-o/2)*(o>e?e/o:1),a=Math.round((Math.atan2(n,s)*(180/Math.PI)+180)/90+3)%4;return a},W=function(t,i){var e,o;switch(t){case 0:n.reverse?(e=0,o=-i.height()):(e=0,o=-i.height());break;case 1:n.reverse?(e=-i.width(),o=0):(e=i.width(),o=0);break;case 2:n.reverse?(e=0,o=-i.height()):(e=0,o=i.height());break;case 3:n.reverse?(e=i.width(),o=0):(e=-i.width(),o=0)}return{from:e,to:o}},O=i("body"),A={interval:"none"},F=0,M=i('<div class="autoGrid-lightbox" />').appendTo(O),z=i('<div class="autoGrid-nav" />').appendTo(M),j=i('<div class="autoGrid-close" />').appendTo(z),R=(i('<i class="iconClose" />').appendTo(j),i('<div class="autoGrid-play" />'));n.lightboxPlayBtn&&R.appendTo(z);var P=(i('<i class="iconPlay" />').appendTo(R),i('<div class="autoGrid-lbcaption" />').appendTo(z).html("Here will go the text for the lightbox")),$=i('<div class="autoGrid-next" />').appendTo(z),q=(i('<i class="iconNext" />').appendTo($),i('<div class="autoGrid-prev" />').appendTo(z)),D=(i('<i class="iconPrev" />').appendTo(q),i('<div class="lightbox-timer" />').appendTo(M)),N=j.width(),Q=3;n.lightboxPlayBtn&&(Q=4);var H=function(){var t=M.outerWidth(!1);650>t?(P.hide(),$.css("width",t/Q),q.css("width",t/Q),R.css("width",t/Q),j.css("width",t-t/Q*(Q-1))):(P.show(),$.css("width",N),q.css("width",N),R.css("width",N),j.css("width",N));var i=M.find("img"),e=M.outerHeight(!1)-z.outerHeight(!1);i.css("max-height",e)};jQuery(t).resize(function(){H()});var Y=new Image,G=function(){Y.onload=null,Y=null,M.find(".lightbox-alignment").remove(),M.find(".lightbox-alignment2").remove(),M.find("img").remove()},J=function(){M.find(".lb-loader").remove()},U=function(){M.append('<div class="lb-loader"/>')};M.attr("unselectable","on").css("user-select","none").on("selectstart",!1);var K=function(){D.stop(!0,!0).width(0)},X=function(){clearInterval(A.interval)},Z=function(){0!=n.lightBoxShowTimer&&D.css({position:"absolute",bottom:0}).animate({width:"100%"},n.lightBoxPlayInterval,"linear",function(){K()})},V=!1,tt=!1,it=function(){A.interval=setTimeout(function(){rt()},n.lightBoxPlayInterval),Z()},et=function(){V&&0==tt&&(K(),X(),it())},ot=i("<span />"),st=function(t,o){G(),J(),U();var s=0,a=0;1!=o&&(s=.9,a=n.lightBoxSpeedFx),0==n.lightBoxZoomAnim&&(s=1);var r=t,h=r.data("lightbox");h==e&&(h=r.attr("src"));var d=r.siblings("div.lightbox-text").html();0==n.lightBoxText&&(d="");var l="<div><div>"+d+"</div></div>";P.html(l),Y=new Image;var c=i(Y),u=Y;Y.onload=function(){if(u==Y){J();var t=i('<div class="lightbox-alignment"></div>').appendTo(M),e=i('<div class="lightbox-alignment2"></div>').appendTo(t);e.append(c.css("margin-top",-z.outerHeight(!1)).hide().scale(s)),c.fadeIn(a).animate({scale:"1"},{duration:n.lightBoxSpeedFx,complete:function(){et()}}),H()}},Y.src=h,ot.stop(!0),ot=i(Y)},nt=!1;a.on("click","div.gbox",function(){nt=!0;var o=i(this);if(!o.hasClass("gridFolder")){var s=o.data("url");if(s!=e)return void(t.location.href="http://"+s);if(0!=n.lightBox){tt=!1,F=a.find(".gbox").index(this);var r=o.children("img");z.animate({"margin-top":0},n.lightBoxSpeedFx),M.fadeIn(n.lightBoxSpeedFx),st(r,!0)}}}),M.on("click","div",function(t){t.stopPropagation()}),M.on("click","img",function(t){t.stopPropagation()}),M.on("click",".lightbox-alignment",function(){at()}),M.on("click",".lightbox-alignment2",function(){at()}),M.on("click",function(){at()}),j.on("click",function(){at()});var at=function(){n.lightBoxStopPlayOnClose&&(R.removeClass("selected"),V=!1),nt=!1,tt=!0,K(),X(),M.find(".lb-loader").remove();var t=0;0==n.lightBoxZoomAnim&&(t=1);var i=M.find("img").stop().show();z.animate({"margin-top":-z.outerHeight(!1)},n.lightBoxSpeedFx),i[0]!=e?i.animate({scale:t},n.lightBoxSpeedFx,function(){M.fadeOut(100)}):M.fadeOut(100)},rt=function(){tt=!1;var t=a.find(".gbox");if(F+=1,F>=t.length&&(F=0),!t.eq(F).is(":visible")||t.eq(F).hasClass("gridFolder"))for(var i=F,e=0;e<t.length;e++){i++,i>=t.length&&(i=0);var o=t.eq(i);if(o.is(":visible")&&0==o.hasClass("gridFolder")){F=i;break}}var s=t.eq(F).children("img");st(s)},ht=function(){tt=!1;var t=a.find(".gbox");if(F-=1,0>F&&(F=t.length-1),!t.eq(F).is(":visible")||t.eq(F).hasClass("gridFolder"))for(var i=F,e=0;e<t.length;e++){i--,0>i&&(i=t.length-1);var o=t.eq(i);if(o.is(":visible")&&0==o.hasClass("gridFolder")){F=i;break}}var s=t.eq(F).children("img");st(s)};$.on("click",function(){K(),X(),rt()}),M.on("click","img",function(){K(),X(),rt()}),q.on("click",function(){K(),X(),ht()}),i(document).keyup(function(t){if(n.lightboxKeyboardNav){if("37"==t.keyCode){if(0==nt)return;K(),X(),ht()}if("39"==t.keyCode){if(0==nt)return;K(),X(),rt()}27==t.keyCode&&at()}}),n.swipeSupport&&(M.on("dragstart",function(t){t.preventDefault()}),M.touchSwipeLeft(function(){K(),X(),rt()}).touchSwipeRight(function(){K(),X(),ht()})),n.lightBoxAutoPlay&&(R.addClass("selected"),V=!0),R.on("click",function(){s=i(this),s.hasClass("selected")?(s.removeClass("selected"),V=!1,K(),X()):(s.addClass("selected"),V=!0,it())})};if("string"==typeof o){var n=Array.prototype.slice.call(arguments,1);this.each(function(){var t=i.data(this,"grid");return t?i.isFunction(t[o])&&"_"!==o.charAt(0)?void t[o].apply(t,n):void a("no such method '"+o+"' for grid instance"):void a("cannot call methods on grid prior to initialization; attempted to call method '"+o+"'")})}else this.each(function(){var t=i.data(this,"grid");t?(t.option(o||{}),t._init()):(s(this),i.data(this,"grid",new i.Mason(o,this)))});return this},i.fn.grid.defaults={imagesOrder:"byName",albumsOrder:"none",folderCoverRandom:!0,foldersAtTop:!0,showNumFolder:!0,showNumImages:!0,autoHideNumFolder:!0,autoHideNumImages:!1,isFitWidth:!0,lazyLoad:!0,showNavBar:!0,imagesToLoadStart:15,imagesToLoad:5,horizontalSpaceBetweenThumbnails:5,verticalSpaceBetweenThumbnails:5,columnWidth:"auto",columns:5,columnMinWidth:195,isAnimated:!0,caption:!0,captionType:"grid",lightBox:!0,lightboxKeyboardNav:!0,lightBoxSpeedFx:500,lightBoxZoomAnim:!0,lightBoxText:!0,lightboxPlayBtn:!0,lightBoxAutoPlay:!1,lightBoxPlayInterval:4e3,lightBoxShowTimer:!0,lightBoxStopPlayOnClose:!1,hashTag:!1,swipeSupport:!1,hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1}}}(window,jQuery);




